---
output: html_document
---

```{r pressure, echo=FALSE, out.width = '80%'}
knitr::include_graphics("Mackenzie Logo.png")
```


| <br>  |  |
| --------------------------- | --------------------- |
| COMPONENTE CURRICULAR:<br>  | Propabilidade e Estatistica Aplicada |
| NOME COMPLETO DO ALUNO:<br> | Nicolas Soares Santos |
| RA:                         | **10370082**          |


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(latex2exp)
library(ggplot2)
```


# Exercícios

----

## Exercício 1

Seja \( X \) a quantidade de tempo (em minutos) que um funcionário dos correios gasta com seu cliente. O tempo é conhecido por ter uma distribuição exponencial com a quantidade média de tempo igual a quatro minutos.

1. Qual a probalilidade de o caixa gastar mais de 3 min no atendimento?

```{r}
prob_mais_de_3_min <- 1 - pexp(3, rate = 1/4)
prob_mais_de_3_min
```


2. Qual o tempo que apresenta iguais chances (50%) do atendimento ser em menos ou em mais tempo?

```{r}
tempo_mediano <- qexp(0.5, rate = 1/4)
tempo_mediano
```

3. Plote o gráfico dessa distribuição. Ela é simétrica?

```{r}
library(ggplot2)

tempo = seq(0, 10, 0.1)
densidade = dexp(tempo, rate = 1/4)


dados <- data.frame(
    tempo,
    densidade
)

ggplot(dados, aes(x = tempo, y = densidade)) +
  geom_line(col = 'blue') +
  labs(x = 'Tempo (minutos)', y = 'Densidade', title = 'Distribuição Exponencial') +
  theme_bw()

```

----

## Exercício 2

O número de dias antes que os viajantes comprem suas passagens aéreas pode ser modelado por uma distribuição exponencial com o tempo médio igual a 15 dias.

1. Encontre a probabilidade de um viajante comprar uma passagem com menos de dez dias de antecedência.

```{r}
prob_menos_de_10_dias <- pexp(10, rate = 1/15)
prob_menos_de_10_dias
```

2. Quantos dias metade de todos os viajantes espera?

```{r}
dias_mediana <- qexp(0.5, rate = 1/15)
dias_mediana
```

----

## Exercício 3

Em média um disco de computador de data centers dura em média 3 anos. A duração da peça do computador é distribuída exponencialmente. Qual é a probabilidade de uma peça de computador durar mais de 2 anos?

```{r}
# Definindo a taxa de falha (ou taxa de decaimento)
taxa_falha <- 1/3  # Taxa de falha em anos^-1

# Encontrando a probabilidade de durar mais de 2 anos
prob_duracao_mais_2_anos <- 1 - pexp(2, rate = taxa_falha)
prob_duracao_mais_2_anos

```

----

## Exercício 4

Em média, 30% das pessoas com menos de 25 anos verificam seu perfil no Facebook antes de sair de casa pela manhã. Suponha que essa porcentagem siga uma distribuição normal com um desvio padrão de cinco por cento.

1. Encontre a probabilidade de que a porcentagem de jovens que acessam o Facebook antes de sair de casa pela manhã seja de pelo menos 30%.

```{r}
# Definindo os parâmetros da distribuição normal
media <- 0.30  # Média (30%)
desvio_padrao <- 0.05  # Desvio padrão (5%)

# Calculando a probabilidade usando a função de distribuição acumulada pnorm
prob_pelo_menos_30 <- 1 - pnorm(0.30, mean = media, sd = desvio_padrao)
prob_pelo_menos_30

```

2. Encontre o percentil 0.95. O que ele significa? (expresse em uma frase)

```{r}
# Encontrando o percentil 0.95 usando a função quantile
percentil_95 <- qnorm(0.95, mean = media, sd = desvio_padrao)
percentil_95

```

----

## Exercício 5

1. Qual é a pontuação z-score de \( x=16 \) para uma distribuição normal \( N(\mu=12, \sigma=3) \)?

```{r}
# Definindo os parâmetros da distribuição normal
media <- 12  # Média
desvio_padrao <- 3  # Desvio padrão
x <- 16  # Valor para o qual queremos encontrar o z-score

# Calculando o z-score usando a fórmula: z = (x - média) / desvio_padrao
z_score <- (x - media) / desvio_padrao
z_score
```

2. O z-score pode ser negativo? Para que valores? Faça um gráfico do z-score para \( x \in [0,18] \) para a distribuição normal \( N(\mu=12, \sigma=3) \).

```{r}
# Gerando valores de x
x_values <- seq(0, 18, by = 0.1)

# Calculando os z-scores correspondentes
z_scores <- (x_values - media) / desvio_padrao

# Plotando o gráfico
plot(x_values, z_scores, type = "l", col = "blue", xlab = "x", ylab = "z-score",
     main = "Gráfico do z-score para a distribuição normal")

# Adicionando uma linha em z = 0
abline(h = 0, col = "red")
```

----

## Exercício 6

Um certo programador senior produz em média 1000 linhas de código semanais com um desvio padrão de 200 linhas. Seu colega trainee, 300 linhas em média por semana, com um desvio padrão de 20 linhas. No último mês a empresa colocou os funcionários em home office e na última semana o primeiro programador produziu 750 linhas e o segundo 190 linhas. Qual parece ter tido o desempenho mais afetado pelo trabalho em casa?

```{r}
# Definindo os parâmetros para o programador sênior
media_1 <- 1000  # Média de linhas de código por semana
desvio_padrao_1 <- 200  # Desvio padrão de linhas de código por semana
linhas_codigo_1 <- 750  # Linhas de código produzidas pelo programador sênior na última semana

# Calculando o z-score para o programador sênior
z_score_1 <- (linhas_codigo_1 - media_1) / desvio_padrao_1

# Definindo os parâmetros para o trainee
media_2 <- 300  # Média de linhas de código por semana
desvio_padrao_2 <- 20  # Desvio padrão de linhas de código por semana
linhas_codigo_2 <- 190  # Linhas de código produzidas pelo trainee na última semana

# Calculando o z-score para o trainee
z_score_2 <- (linhas_codigo_2 - media_2) / desvio_padrao_2

# Comparando os z-scores para determinar qual programador teve seu desempenho mais afetado
if (abs(z_score_1) > abs(z_score_2)) {
  print("O programador sênior teve seu desempenho mais afetado pelo trabalho em casa.")
} else if (abs(z_score_1) < abs(z_score_2)) {
  print("O programador trainee teve seu desempenho mais afetado pelo trabalho em casa.")
} else {
  print("Ambos os programadores tiveram seu desempenho afetado de forma semelhante pelo trabalho em casa.")
}

# Verificando o quão afetado foi o rendimento do trainee em termos de desvios padrão
diferenca_desvios <- abs(z_score_2 - 0)  # 0 representa a média esperada
print(paste("O rendimento do programador trainee caiu", round(diferenca_desvios, 1), "desvios padrão."))
```

----

## Exercício 7

Em uma empresa gasta com seus empregados em média 9 horas com treinamentos de políticas de bem estar por ano. Palestras de saúde, alimentação etc. A empresa vê uma oportunidade de reduzir os custos desse treinamento contratando antecipadamente as horas de treinamento. Ela então quer cobrir o treinamento de 90% dos funcionários. Sabendo a quantidade de horas de treinamento tem um desvio padrão de 2 horas e a empresa tem 500 funcionários, quantas horas de treinamento ela buscará negociar para o ano?

```{r}
# Definindo os parâmetros
media <- 9  # Média de horas de treinamento por ano
desvio_padrao <- 2  # Desvio padrão de horas de treinamento por ano
percentil <- 0.9  # Percentil desejado (90% dos funcionários)

# Calculando o número de horas de treinamento para cobrir 90% dos funcionários
horas_treinamento <- qnorm(percentil, mean = media, sd = desvio_padrao)

# Calculando o total de horas de treinamento necessárias para cobrir todos os funcionários
total_horas_treinamento <- horas_treinamento * 500

total_horas_treinamento

```

----

## Exercício 8

Pacientes de covid-19 de um hospital levam em média 14 dias, distribuídos normalmente, para se reestabelecer. Existem 30 pacientes de covid-19 internados. Qual a chance desses pacientes saírem em média com menos de 12 e 13 dias se reestabelecer?

* Dica: Para 30 amostras a distribuição t-Student tem valores próximos da normal

```{r}
# Definindo os parâmetros
mu <- 14
sigma <- 14
n <- 30

# Calculando as probabilidades
prob_menos_de_12 <- pnorm(12, mean = mu, sd = sigma / sqrt(n))
prob_menos_de_13 <- pnorm(13, mean = mu, sd = sigma / sqrt(n))

# Exibindo os resultados
prob_menos_de_12
prob_menos_de_13
```

----

## Exercício 9

Faça um gráfico da distribuição Chi-quadrado com diferentes graus de liberdade. Para que valores de graus de liberdade entre 10, 20 e 30 a distribuição apresenta valores mais dispersos?

```{r}
library(latex2exp)

# Definindo os graus de liberdade
df_values <- c(10, 20, 30)

# Criando o layout dos gráficos
par(mfrow = c(1, 3))

# Loop para criar os gráficos para diferentes graus de liberdade
for (df in df_values) {
  # Gerando valores de x
  x <- seq(0, 60, 1)
  
  # Calculando a densidade de probabilidade
  prob <- dchisq(x, df = df)
  
  # Plotando a densidade de probabilidade
  plot(x,
       prob,
       type = 'l',
       xlab = TeX('Valor'),
       ylab = TeX('Função Densidade de Probabilidade'),
       col = 'darkblue',
       main = TeX(sprintf('PDF, Chi-quadrado(df=%d)', df)))
  
  # Calculando a probabilidade acumulada
  prob_acumulada <- pchisq(x, df = df)
  
  # Plotando a probabilidade acumulada
  plot(x,
       prob_acumulada,
       type = 'l',
       xlab = TeX('Valor'),
       ylab = TeX('Função Probabilidade Acumulada'),
       col = 'darkblue',
       main = TeX(sprintf('CDF, Chi-quadrado(df=%d)', df)))
}

# Restaurando o layout padrão
par(mfrow = c(1, 1))

```
